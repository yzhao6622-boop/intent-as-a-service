# å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## ğŸš€ æœ€ç®€å•æ–¹å¼ï¼šRailwayï¼ˆ5åˆ†é’Ÿéƒ¨ç½²ï¼‰

### æ­¥éª¤1ï¼šå‡†å¤‡ä»£ç 

ç¡®ä¿ä»£ç å·²æ¨é€åˆ° GitHubï¼š
```bash
git add .
git commit -m "å‡†å¤‡éƒ¨ç½²"
git push
```

### æ­¥éª¤2ï¼šéƒ¨ç½²åˆ° Railway

1. è®¿é—® https://railway.app
2. ç‚¹å‡» "Start a New Project"
3. é€‰æ‹© "Deploy from GitHub repo"
4. æˆæƒå¹¶é€‰æ‹©æ‚¨çš„ä»“åº“
5. Railway ä¼šè‡ªåŠ¨å¼€å§‹éƒ¨ç½²

### æ­¥éª¤3ï¼šé…ç½®ç¯å¢ƒå˜é‡

åœ¨ Railway é¡¹ç›®è®¾ç½® â†’ Variables ä¸­æ·»åŠ ï¼š

```
NODE_ENV=production
JWT_SECRET=ç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ï¼ˆè‡³å°‘32å­—ç¬¦ï¼‰
ARK_API_KEY=ä½ çš„ç«å±±æ–¹èˆŸAPIå¯†é’¥
ARK_MODEL_ID=ä½ çš„æ¨¡å‹ID
ARK_API_BASE_URL=https://ark.cn-beijing.volces.com/api/v3
PORT=3002
```

### æ­¥éª¤4ï¼šç­‰å¾…éƒ¨ç½²å®Œæˆ

Railway ä¼šæä¾›ç±»ä¼¼ `https://your-app.railway.app` çš„ URL

### æ­¥éª¤5ï¼šéƒ¨ç½²å‰ç«¯ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦å•ç‹¬éƒ¨ç½²å‰ç«¯ï¼š

1. åœ¨ Railway æ·»åŠ æ–°æœåŠ¡
2. é€‰æ‹© `client` ç›®å½•
3. æ„å»ºå‘½ä»¤ï¼š`npm install && npm run build`
4. å¯åŠ¨å‘½ä»¤ï¼š`npx serve -s dist -p 3000`

---

## ğŸŒ åˆ†ç¦»éƒ¨ç½²ï¼šVercelï¼ˆå‰ç«¯ï¼‰+ Railwayï¼ˆåç«¯ï¼‰

### åç«¯éƒ¨ç½²ï¼ˆRailwayï¼‰

æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤1-4éƒ¨ç½²åç«¯ï¼Œè·å–åç«¯URLã€‚

### å‰ç«¯éƒ¨ç½²ï¼ˆVercelï¼‰

1. **å®‰è£… Vercel CLI**
```bash
npm i -g vercel
```

2. **ç™»å½• Vercel**
```bash
vercel login
```

3. **éƒ¨ç½²å‰ç«¯**
```bash
cd client
vercel
```

4. **é…ç½®ç¯å¢ƒå˜é‡**
åœ¨ Vercel Dashboard â†’ Settings â†’ Environment Variables æ·»åŠ ï¼š
```
VITE_API_URL=https://your-backend.railway.app/api
```

5. **é‡æ–°éƒ¨ç½²**
```bash
vercel --prod
```

---

## ğŸ“¦ ä½¿ç”¨ Docker éƒ¨ç½²ï¼ˆé«˜çº§ï¼‰

### åˆ›å»º Dockerfile

```dockerfile
# æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder

WORKDIR /app

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY package*.json ./
COPY tsconfig.json ./

# å®‰è£…ä¾èµ–
RUN npm ci

# å¤åˆ¶æºä»£ç 
COPY . .

# æ„å»º
RUN npm run build:server
RUN cd client && npm ci && npm run build

# è¿è¡Œé˜¶æ®µ
FROM node:18-alpine

WORKDIR /app

# åªå¤åˆ¶å¿…è¦æ–‡ä»¶
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/client/dist ./client/dist
COPY --from=builder /app/package*.json ./
COPY --from=builder /app/node_modules ./node_modules

# æš´éœ²ç«¯å£
EXPOSE 3002

# å¯åŠ¨
CMD ["node", "dist/server.js"]
```

### æ„å»ºå’Œè¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker build -t intent-service .

# è¿è¡Œå®¹å™¨
docker run -p 3002:3002 --env-file .env intent-service
```

---

## ğŸ”§ éƒ¨ç½²å‰æ£€æŸ¥

è¿è¡Œä»¥ä¸‹å‘½ä»¤ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼š

```bash
# 1. æ£€æŸ¥ç¯å¢ƒå˜é‡
node check-env.js

# 2. æ„å»ºæµ‹è¯•
npm run build

# 3. æœ¬åœ°æµ‹è¯•ç”Ÿäº§æ„å»º
npm start
```

---

## ğŸ“ éƒ¨ç½²åéªŒè¯

1. **æ£€æŸ¥å¥åº·çŠ¶æ€**
```bash
curl https://your-backend-url/health
```

2. **æµ‹è¯•API**
```bash
curl https://your-backend-url/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@test.com","password":"test123"}'
```

3. **è®¿é—®å‰ç«¯**
æ‰“å¼€æµè§ˆå™¨è®¿é—®å‰ç«¯URLï¼Œæµ‹è¯•æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ã€‚

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šæ„å»ºå¤±è´¥

**è§£å†³**ï¼šæ£€æŸ¥ `package.json` ä¸­çš„æ„å»ºè„šæœ¬æ˜¯å¦æ­£ç¡®ã€‚

### é—®é¢˜2ï¼šç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆ

**è§£å†³**ï¼šç¡®ä¿åœ¨å¹³å°è®¾ç½®ä¸­æ­£ç¡®é…ç½®ï¼Œå¹¶é‡å¯æœåŠ¡ã€‚

### é—®é¢˜3ï¼šæ•°æ®åº“æ–‡ä»¶ä¸¢å¤±

**è§£å†³**ï¼šä½¿ç”¨æŒä¹…åŒ–å­˜å‚¨å·ï¼Œæˆ–è¿ç§»åˆ°äº‘æ•°æ®åº“ã€‚

### é—®é¢˜4ï¼šCORS é”™è¯¯

**è§£å†³**ï¼šæ£€æŸ¥ `src/server.ts` ä¸­çš„ CORS é…ç½®ï¼Œç¡®ä¿å…è®¸å‰ç«¯åŸŸåã€‚

---

## ğŸ’¡ æ¨èé…ç½®

### ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ

1. âœ… ä½¿ç”¨ HTTPSï¼ˆRailway/Vercel è‡ªåŠ¨æä¾›ï¼‰
2. âœ… è®¾ç½®å¼º JWT_SECRET
3. âœ… å¯ç”¨æ•°æ®åº“å¤‡ä»½
4. âœ… é…ç½®ç›‘æ§å’Œæ—¥å¿—
5. âœ… è®¾ç½®é”™è¯¯è¿½è¸ªï¼ˆå¦‚ Sentryï¼‰

### æ€§èƒ½ä¼˜åŒ–

1. å¯ç”¨ CDNï¼ˆVercel è‡ªåŠ¨ï¼‰
2. ä½¿ç”¨ç¼“å­˜ç­–ç•¥
3. å‹ç¼©é™æ€èµ„æº
4. æ•°æ®åº“è¿æ¥æ± 

---

## ğŸ¯ ä¸‹ä¸€æ­¥

éƒ¨ç½²å®Œæˆåï¼š

1. é…ç½®è‡ªå®šä¹‰åŸŸå
2. è®¾ç½®ç›‘æ§å’Œå‘Šè­¦
3. é…ç½® CI/CD è‡ªåŠ¨éƒ¨ç½²
4. è®¾ç½®æ•°æ®åº“å¤‡ä»½ç­–ç•¥
