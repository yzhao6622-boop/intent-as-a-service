# 前端环境变量配置说明

## 📋 配置目的

配置 `VITE_API_URL` 环境变量，确保前端能正确访问后端 API，解决删除功能和其他 API 调用失败的问题。

## 🔧 自动检测功能

代码已优化，支持**自动检测**后端地址：

- **本地开发**（localhost/127.0.0.1）：自动使用代理 `/api`
- **远程访问**：自动使用 `http://当前hostname:3002/api`

**即使不配置环境变量，也能正常工作！**

## 📝 手动配置（可选）

如果需要手动指定后端地址，可以配置 `client/.env` 文件：

### 方式1：使用配置脚本（推荐）

运行：
```bash
配置前端环境变量.bat
```

### 方式2：手动编辑

编辑 `client/.env` 文件：

```env
# 选项1: 自动检测（留空或删除此行）
VITE_API_URL=

# 选项2: 指定完整地址
VITE_API_URL=http://8.134.184.83:3002/api

# 选项3: 使用代理（仅本地开发）
VITE_API_URL=/api
```

## 🚀 应用配置

配置完成后，需要重启前端服务：

### 使用 PM2

```bash
pm2 restart intent-frontend
```

### 开发模式

```bash
# 停止当前服务（Ctrl+C）
cd client
npm run dev
```

## ✅ 验证配置

1. 打开浏览器开发者工具（F12）
2. 切换到 Console 标签
3. 刷新页面
4. 应该看到：`API Base URL: http://8.134.184.83:3002/api`（或你的后端地址）

## 🔍 检查当前配置

查看 `client/.env` 文件内容：

```bash
cd client
type .env
```

## 📌 注意事项

1. **Vite 环境变量**必须以 `VITE_` 开头
2. **修改后必须重启**前端服务才能生效
3. **生产环境**建议明确指定后端地址
4. **开发环境**可以使用代理或自动检测

## 🆘 常见问题

### Q: 配置后仍然失败？

**A:** 检查：
1. `.env` 文件是否在 `client/` 目录下
2. 环境变量名是否正确：`VITE_API_URL`（注意 VITE_ 前缀）
3. 是否重启了前端服务
4. 浏览器控制台的 API Base URL 是什么

### Q: 如何确认配置生效？

**A:** 
1. 打开浏览器控制台
2. 查看 `API Base URL` 日志
3. 在 Network 标签中查看请求 URL
4. 应该指向后端服务器（端口 3002），而不是前端服务器（端口 5173）

### Q: 自动检测不工作？

**A:** 手动设置环境变量：
```env
VITE_API_URL=http://你的服务器IP:3002/api
```

## 💡 推荐配置

### 服务器部署（生产环境）

```env
VITE_API_URL=http://8.134.184.83:3002/api
```

### 本地开发

```env
VITE_API_URL=/api
```

或留空（使用自动检测）
