# 启动说明

## 前置要求

1. Node.js 18+ 
2. npm 或 yarn
3. 火山方舟（Ark）API密钥（用于AI功能）

## 快速启动步骤

### 1. 安装依赖

```bash
# 安装后端依赖
npm install

# 安装前端依赖
cd client
npm install
cd ..
```

### 2. 配置环境变量

创建 `.env` 文件（参考 `.env.example`）：

```env
PORT=3002
NODE_ENV=development
JWT_SECRET=your-secret-key-change-in-production
ARK_API_KEY=your-ark-api-key-here
ARK_MODEL_ID=ep-20241208200930-xxxxx
DB_PATH=./data/intent.db
```

**重要**：
- 请将 `ARK_API_KEY` 替换为您的火山方舟API密钥
- 请将 `ARK_MODEL_ID` 替换为您在火山方舟控制台创建的模型访问点ID（例如：ep-20241208200930-xxxxx）
- 可以在火山方舟模型商城选择模型（如DeepSeek V3、R1等）并创建访问点获取模型ID

### 3. 初始化数据库

```bash
npm run migrate
```

这将创建SQLite数据库和所有必要的表。

### 4. 启动应用

**方式一：同时启动前后端（推荐）**

```bash
npm run dev
```

**方式二：分别启动**

```bash
# 终端1：启动后端
npm run dev:server

# 终端2：启动前端
npm run dev:client
```

### 5. 访问应用

- 前端：http://localhost:5173
- 后端API：http://localhost:3002
- 健康检查：http://localhost:3002/health

## 首次使用

1. 访问 http://localhost:5173
2. 注册一个新账户
3. 创建您的第一个意图，例如：
   - "我打算在90天内，从零基础转行做前端工程师"
   - "我计划在6个月内完成买房决策"
   - "我准备在3个月内决定是否接受手术"
4. AI将分析您的意图并生成意图档案
5. 与AI审计员对话，验证您的真实意图
6. 追踪您的意图进展

## 常见问题

### Q: 火山方舟API调用失败？
A: 请确保：
- 已正确设置 `ARK_API_KEY` 和 `ARK_MODEL_ID`
- API密钥有效且有足够余额
- 网络可以访问火山方舟API
- 模型ID格式正确（通常以 ep- 开头）

### Q: 数据库错误？
A: 请确保：
- 已运行 `npm run migrate`
- `data/` 目录有写入权限

### Q: 前端无法连接后端？
A: 请确保：
- 后端服务正在运行（端口3002）
- Vite代理配置正确（已在vite.config.ts中配置）

## 生产部署

### 构建

```bash
# 构建后端
npm run build:server

# 构建前端
npm run build:client
```

### 运行

```bash
# 设置生产环境变量
export NODE_ENV=production
export JWT_SECRET=your-production-secret
export ARK_API_KEY=your-production-ark-key
export ARK_MODEL_ID=your-production-model-id

# 启动服务器
npm start
```

## 开发建议

- 使用VS Code或Cursor进行开发
- 安装ESLint和Prettier插件
- 数据库文件位于 `data/intent.db`，可以删除后重新运行migrate来重置
